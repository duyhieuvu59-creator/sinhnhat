<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Thi·ªáp Sinh Nh·∫≠t 3D</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
    }
    canvas { display: block; }
  </style>
</head>
<body>
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
  <script>
    let scene = new THREE.Scene();
    let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    let renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const messages = [
      "üéâ Grattis p√• f√∂delsedagen",
      "üéÇ Ch√∫c mthu sinh nh·∫≠t vui v·∫ª ^^",
      "ü•≥ Tu·ªïi m·ªõi th·∫≠t nhi·ªÅu ni·ªÅm vui:3",
      "üå∏ Lu√¥n h·∫°nh ph√∫c v√† th√†nh c√¥ng!",
      "üíù Ng√†y c√†ng xinh ƒë·∫πp nh√© üòç",
      "‚ú® Happy Birthday! ‚ú®"
    ];
    let texts = [];

    function createTextSprite(message, color="#ff66ff") {
      let canvas = document.createElement("canvas");
      canvas.width = 2048;
      canvas.height = 512;
      let ctx = canvas.getContext("2d");
      ctx.font = "Bold 120px Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.shadowColor = "rgba(255,255,255,0.9)";
      ctx.shadowBlur = 25;
      ctx.lineWidth = 6;
      ctx.strokeStyle = "white";
      ctx.strokeText(message, canvas.width/2, canvas.height/2);
      ctx.fillStyle = color;
      ctx.fillText(message, canvas.width/2, canvas.height/2);

      let texture = new THREE.CanvasTexture(canvas);
      let material = new THREE.SpriteMaterial({ map: texture, transparent: true });
      let sprite = new THREE.Sprite(material);
      sprite.scale.set(canvas.width * 0.015, canvas.height * 0.015, 1);
      sprite.center.set(0.5, 0.5);
      return sprite;
    }

    messages.forEach(msg => {
      let sprite = createTextSprite(msg);
      sprite.position.set(0, (Math.random()-0.5)*8, -Math.random()*100 - 10);
      scene.add(sprite);
      texts.push(sprite);
    });

    // üéÜ Ph√°o hoa nhi·ªÅu m√†u
    let fireworks = [];
    function createFirework() {
      let geometry = new THREE.BufferGeometry();
      let particles = 150;
      let positions = new Float32Array(particles * 3);
      let velocities = [];

      for (let i = 0; i < particles; i++) {
        // V·ªã tr√≠ ban ƒë·∫ßu t·∫°i t√¢m
        positions[i*3] = 0;
        positions[i*3+1] = 0;
        positions[i*3+2] = 0;

        // V·∫≠n t·ªëc ng·∫´u nhi√™n ƒë·ªÉ bay ra ngo√†i
        let angle = Math.random() * Math.PI * 2;
        let speed = Math.random() * 0.2 + 0.05;
        let vz = (Math.random()-0.5) * 0.1;
        velocities.push({
          x: Math.cos(angle) * speed,
          y: Math.sin(angle) * speed,
          z: vz
        });
      }

      geometry.setAttribute("position", new THREE.BufferAttribute(positions, 3));

      // üåà M√†u ng·∫´u nhi√™n
      const colors = [0xff4444, 0xffff66, 0x66ff66, 0x66ccff, 0xff99ff, 0xff9966];
      let color = colors[Math.floor(Math.random()*colors.length)];
      let material = new THREE.PointsMaterial({ color: color, size: 0.15, transparent: true });

      let pts = new THREE.Points(geometry, material);
      pts.position.set((Math.random()-0.5)*12, (Math.random()-0.5)*7, -20);

      scene.add(pts);
      fireworks.push({obj: pts, vel: velocities, life: 80});
    }

    function updateFireworks(){
      fireworks.forEach((fw, idx)=>{
        let positions = fw.obj.geometry.attributes.position.array;
        for (let i=0; i<fw.vel.length; i++){
          positions[i*3]   += fw.vel[i].x;
          positions[i*3+1] += fw.vel[i].y;
          positions[i*3+2] += fw.vel[i].z;
        }
        fw.obj.geometry.attributes.position.needsUpdate = true;

        fw.life--;
        fw.obj.material.opacity = fw.life / 80;
        if (fw.life <= 0){
          scene.remove(fw.obj);
          fireworks.splice(idx, 1);
        }
      });
    }

    camera.position.z = 5;
    function animate(){
      requestAnimationFrame(animate);
      texts.forEach(t=>{
        t.position.z += 0.03; 
        if (t.position.z > 5) t.position.z = -100;
      });
      if (Math.random() < 0.02) createFirework();
      updateFireworks();
      renderer.render(scene, camera);
    }
    animate();

    window.addEventListener("resize", ()=>{
      camera.aspect = window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
